<!DOCTYPE html>
<html>

  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.form/4.2.2/jquery.form.min.js" integrity="sha256-2Pjr1OlpZMY6qesJM68t2v39t+lMLvxwpa8QlRjJroA=" crossorigin="anonymous"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <style>
      html,
      body {
        margin-left: 10px;
      }

      h3 a {
        font-weight: normal;
        color: Sienna;
      }

    </style>

  </head>

  <body>



    <div id="div"></div><br>
    <script>
      $(function() {
        var sheetUrl = 'https://spreadsheets.google.com/feeds/list/1gPV1KpSUCEE-0OebVmyy2Fpn-xRd8CvS0gC3E8BwzHc/7/public/full?alt=json';
        $.getJSON(sheetUrl, function(data) {
          var entry = data.feed.entry;
          console.log(entry);
          var x = document.getElementById("div");
          entry.forEach(function(item, index) {

            x.innerHTML += '<a href="#" id="' + item.gsx$id.$t + '" onclick="myFunction(\'' + item.gsx$id.$t + '\')">' + item.gsx$task.$t + '</a><br>';
          });
        });
      });

      function myFunction(gsxid) {
        var idgsx = document.getElementById("1054571296");
        idgsx.value = gsxid;
        var order = document.getElementById("529958228");
        //   order.value = Date.now() - 1550983776068 - 299874;
        order.value = Date.now()
        var task = document.getElementById("688970287");
        task.value = document.getElementById(gsxid).textContent;
        document.getElementById("bootstrapForm").submit();
      }

      function addParams() {
        var idgsx = document.getElementById("1054571296");
        idgsx.value = Date.now() - 1550983776068 - 299874;
      }

    </script>



    <br><br>
    <form action="https://docs.google.com/forms/d/e/1FAIpQLSfSZ1PlLMMy7DZ6dcDnLWLcyvgpJdEuyzXpiTnIU0WmYwPdXw/formResponse" target="_self" id="bootstrapForm" method="POST">



      <legend for="1903312169">Task</legend>
      <div class="form-group">
        <textarea id="688970287" name="entry.688970287" class="form-control"></textarea>

      </div>


      <input id="529958228" type="hidden" name="entry.529958228" class="form-control">
      <input id="1054571296" type="hidden" name="entry.1054571296" class="form-control">
      <input type="hidden" name="fvv" value="1">
      <input type="hidden" name="fbzx" value="1284283036980352758">

      <input type="hidden" name="pageHistory" value="0">

      <input onclick="addParams()" type="submit" value="Submit">
    </form>

    <script>
      $('#bootstrapForm').submit(function(event) {
        event.preventDefault()
        var extraData = {}
        $('#bootstrapForm').ajaxSubmit({
          data: extraData,
          dataType: 'jsonp', // This won't really work. It's just to use a GET instead of a POST to allow cookies from different domain.
          error: function() {
            // Submit of form should be successful but JSONP callback will fail because Google Forms
            // does not support it, so this is handled as a failure.
            alert('Form Submitted. Thanks.')
            location.reload();
            // You can also redirect the user to a custom thank-you page:
            // window.location = 'http://www.mydomain.com/thankyoupage.html'
          }
        })
      })

    </script>
    <br><br>
    <a href="https://docs.google.com/spreadsheets/d/1gPV1KpSUCEE-0OebVmyy2Fpn-xRd8CvS0gC3E8BwzHc/edit#gid=1122416897">Admin</a>
  </body>

</html>
